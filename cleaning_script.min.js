'use strict';mw.loader.using("mediawiki.storage").then(function(){mw.storage.session.set("client-error-opt-out","1")});function mergeDuplicateRefs(a){var d={};a=a.replace(/<ref\s+name\s*=\s*"(.*?)">(.*?)<\/ref>/g,function(b,c,e){if(d[c])return d[c]++,`<ref name="${c}" />`;d[c]=1;return b});console.log(a);return a}
function runAutoFix(a){function d(){a.waitAfterRunning||(a.textBox=null,a.sumarioEl=null);a.waitAfterRunning=void 0;if(a.ve&&a.ve.init)if("source"==a.ve.init.target.surface.getMode())textBox={valor:a.ve.init.target.surface.model.documentModel.data.getSourceText(),get value(){return null==this.valor?"":this.valor},set value(c){this.valor=c.toString()}};else return;else if(a.wikEd&&a.wikEd.textarea)!0===a.wikEd.useWikEd&&a.wikEd.UpdateTextarea(),textBox=a.wikEd.textarea,a.wikEd.useWikEd=!1;else if(a.$(".CodeMirror").length)try{textBox=
a.$(".CodeMirror")[0].CodeMirror,textBox.__defineGetter__("value",function(){return this.getValue()}),textBox.__defineSetter__("value",function(c){this.setValue(c)})}catch(c){textBox=a.document.getElementById("wpTextbox1")}else textBox=a.document.getElementById("wpTextbox1");window.sumarioEl||(sumarioEl=a.document.getElementById("wpSummary"));var b=textBox.value;aviso=!1;textBox.value=mergeDuplicateRefs(b);sumarioEl.value+=" + desduplicando refer\u00eancias usando [[user:TiagoLubiana/Desduplicador.js|script desduplicador]]";
if(a.ve&&a.ve.init)aviso&&!window.avisove?avisove=!0:(avisove=!1,b=$('<form style="display:none" method="post" action="/wiki/'+a.mw.config.get("wgPageName")+'"><input name="action" value="submit"><textarea name="wpTextbox1"></textarea><input name="wpSummary" value="'+sumarioEl.value+'"><input name="wpMinoredit" value="on"><input name="wpDiff" value="Mostrar altera\u00e7\u00f5es"><input name="editRevId" value="'+a.mw.config.get("wgCurRevisionId")+'"><input name="parentRevId" value="'+a.mw.config.get("wgCurRevisionId")+
'"><input name="baseRevId" value="'+a.mw.config.get("wgCurRevisionId")+'"><input name="wpStarttime" value="'+(new Date).toISOString().replace(/[^0-9]/g,"").slice(0,-3)+($("#ca-unwatch").length?'"><input name="wpWatchthis" checked type="checkbox':"")+'"><input name="mode" value="diff"><input name="model" value="wikitext"><input name="format" value="text/x-wiki"><input name="wpUltimateParam" value="1"></form>'),b.find("textarea").val(textBox.value),$(document.body).append(b),window.onbeforeunload=null,
b.submit());else{if(b=a.document.getElementById("wpMinoredit"))b.checked=!0;aviso||a.document.getElementById("wpDiff").click();sumarioEl=textBox=null}}a==window?d():$(a).load(d)}
document.getElementById("wpTextbox1")&&document.getElementById("wpDiff")&&(document.getElementById("wpDiff").outerHTML=document.getElementById("wpDiff").outerHTML.replace('accesskey="v"','accesskey="d"').replace("alt-shift-v","alt-shift-d")+'\n<input id="Desduplicar refer\u00eancias" name="Desduplicar refer\u00eancias" tabindex="7" title="Desduplicar refer\u00eancias [alt-shift-a]" type="button" class="'+$("#wpDiff").prop("class")+'" value="Desduplicar refer\u00eancias" accesskey="a" onclick="runAutoFix(window)">');